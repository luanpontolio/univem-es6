<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Async Await</title>
</head>
<body>
    <script>
        // Async Await.
        // var films = fetch("https://swapi.co/api/people/?format=json");

        // films
        //     .then(data => data.json())
        //     .then(data => data.results.map(film => {
        //         console.log(film.name);
        //     }));

        // A palavra async irá informar que a função é asyncrona.
        async function getFetch() {
            // return fetch("https://swapi.co/api/people/?format=json")
            //         .then(data => data.json())
            //         .then(data => data.results.map(film => {
            //             console.log(film.name);
            //         }));

            // A palavra chave await irá forçar que a promise
            // aguarde sua finalização.
            const response = await fetch("https://swapi.co/api/people/?format=json");
            // Deve-se adicionar 'await' na frente pois ele deve aguardar que 
            // a promise execute de fato.
            const data     = await response.json();

            return data.results.map(film => {
                console.log(film.name);
            })

            // console.log(response);
        }

        getFetch();

        /*
            - async/await funciona obrigatoriamente no protocolo de Promise
            - async é a palavra chave usada no incio de uma função
            - await é usada para aviar a função aguardar o resultado da promise
            - await só pode ser usada para uma função com await
            - async/await já esta funcionando em quase todos os Browsers e NodeJs

            Vantagens de usar async
            
            - O codigo fica mais simplificado
            - Mais facil de debugar por ter menos callbacks
            - A conversão de uma promise para async/await é bem simples;
            - O código fica com menos encadiamento.   
        */
    </script>
</body>
</html>